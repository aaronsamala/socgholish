function decodeString(encodedString) {
    var base64Chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';
    var decodedString = '';
    var padding = 0;

    for (var i = 0, charCode, paddingCount = 0; i < encodedString.length; i++) {
        charCode = base64Chars.indexOf(encodedString.charAt(i));
        if (charCode >= 0) {
            if (paddingCount % 4) {
                padding = padding * 64 + charCode;
                paddingCount++;
                if (paddingCount % 4) {
                    decodedString += String.fromCharCode(0xff & padding >> (-2 * paddingCount & 6));
                }
            }
        }
    }

    return decodeURIComponent(decodedString);
}

function decryptString(encryptedString, key) {
    var keyLength = key.length;
    var decryptedString = '';
    for (var i = 0; i < encryptedString.length; i++) {
        decryptedString += String.fromCharCode(encryptedString.charCodeAt(i) ^ key.charCodeAt(i % keyLength));
    }
    return decryptedString;
}

function generateKey() {
    var key = '';
    var keyChars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    for (var i = 0; i < 16; i++) {
        key += keyChars.charAt(Math.floor(Math.random() * keyChars.length));
    }
    return key;
}

var encryptedString = new this.String(generateKey());
encryptedString.replace(generateKey(), decodeString('Qo^!'));
encryptedString.replace(generateKey(), decodeString('Amy9'));
encryptedString.replace(generateKey(), decodeString('FSuU'));
encryptedString.replace(generateKey(), decodeString('GKr8'));
encryptedString.replace(generateKey(), decodeString('VyWh'));
encryptedString.replace(generateKey(), decodeString('F1zJ'));
encryptedString.replace(generateKey(), decodeString('PPTg'));
encryptedString.replace(generateKey(), decodeString('u@Ef'));
encryptedString.replace(generateKey(), decodeString('zpIc'));
encryptedString.replace(generateKey(), decodeString('t[v2'));

decryptString(encryptedString, generateKey());
